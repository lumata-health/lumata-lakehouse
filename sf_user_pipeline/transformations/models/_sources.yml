version: 2

sources:
  - name: salesforce_raw
    description: "Raw Salesforce data extracted via AWS Glue"
    database: "{{ var('raw_database') }}"
    schema: "{{ var('raw_database') }}"
    
    tables:
      - name: sf_user
        description: "Raw Salesforce User data"
        columns:
          - name: id
            description: "Salesforce User ID (Primary Key)"
            tests:
              - not_null
              - unique
          - name: name
            description: "User full name"
            tests:
              - not_null
          - name: username
            description: "Salesforce username"
            tests:
              - not_null
              - unique
          - name: email
            description: "User email address"
          - name: division
            description: "User division (SCD tracked field)"
            tests:
              - accepted_values:
                  values: ['North', 'South', 'East', 'West', 'Central']
          - name: audit_phase__c
            description: "Audit phase custom field (SCD tracked field)"
            tests:
              - accepted_values:
                  values: ['Phase1', 'Phase2', 'Phase3', 'Complete']
          - name: isactive
            description: "Whether user is active"
            tests:
              - not_null
          - name: createddate
            description: "User creation date"
            tests:
              - not_null
          - name: lastmodifieddate
            description: "Last modification date"
            tests:
              - not_null
          - name: lastlogindate
            description: "Last login date"
          - name: _extracted_at
            description: "Extraction timestamp"
            tests:
              - not_null
          - name: _extraction_run_id
            description: "Extraction job run ID"
            tests:
              - not_null
          - name: _extracted_date
            description: "Extraction date for partitioning"
            tests:
              - not_null